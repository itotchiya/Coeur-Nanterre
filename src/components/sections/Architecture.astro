---
/**
 * Architecture Section
 * Entre histoire et contemporain
 */
import AnimatedVerticalLine from "../ui/AnimatedVerticalLine.astro";
import Button from "../ui/Button.astro";

// Import architecture images (AVIF - using directly, already optimized)
import historicResidential from "../../assets/historic-residential.avif";
import arch22 from "../../assets/arch22.avif";
import arch30 from "../../assets/arch30.avif";
---

<section
  class="architecture"
  data-section="architecture"
  id="architecture"
  aria-labelledby="architecture-title"
>
  <div class="architecture__container">
    <!-- Left Column: Sticky Text -->
    <div class="architecture__text-col">
      <h2
        id="architecture-title"
        class="architecture__title type-h2"
        data-animate="fade-up"
      >
        Un dialogue entre<br />ancien et neuf
      </h2>

      <div class="architecture__subtitle-group">
        <AnimatedVerticalLine height="100%" />
        <span
          class="architecture__subtitle type-tagline"
          data-animate="fade-up"
        >
          Une écriture architecturale<br />de transition
        </span>
      </div>

      <div class="architecture__content" data-animate="fade-up">
        <p class="architecture__paragraph type-body">
          Le projet s'inscrit dans une démarche respectueuse du tissu urbain
          existant. Une écriture subtile qui ne cherche pas à s'imposer, mais à
          s'intégrer.
        </p>

        <p class="architecture__paragraph type-body">
          La réhabilitation permet de préserver l'âme du lieu, ses volumes et
          son cachet, tandis que les constructions neuves apportent une touche
          contemporaine, sobre et durable.
        </p>

        <p class="architecture__paragraph type-body">
          Cœur Nanterre revendique une architecture de transition, à la croisée
          de l'histoire locale et des modes de vie actuels.
        </p>

        <div style="margin-top: 2rem;">
          <Button
            href="#"
            variant="primary"
            class="js-download-brochure btn--full-mobile"
          >
            Télécharger la plaquette
          </Button>
        </div>
      </div>
    </div>

    <!-- Right Column: Scrolling Images -->
    <div class="architecture__image-col">
      <!-- Image 1 -->
      <figure class="architecture__figure" data-animate="image-reveal">
        <div class="architecture__image-wrapper">
          <img
            src={historicResidential.src}
            alt="Façade ancienne réhabilitée"
            class="architecture__image"
            loading="lazy"
          />
        </div>
        <figcaption class="architecture__caption">
          La Façade Historique
        </figcaption>
      </figure>

      <!-- Image 2 -->
      <figure class="architecture__figure" data-animate="image-reveal">
        <div class="architecture__image-wrapper">
          <img
            src={arch22.src}
            alt="Extension moderne"
            class="architecture__image"
            loading="lazy"
          />
        </div>
        <figcaption class="architecture__caption">
          Une Extension Moderne
        </figcaption>
      </figure>

      <!-- Image 3 -->
      <figure class="architecture__figure" data-animate="image-reveal">
        <div class="architecture__image-wrapper">
          <img
            src={arch30.src}
            alt="Intérieur lumineux"
            class="architecture__image"
            loading="lazy"
          />
        </div>
        <figcaption class="architecture__caption">
          Des Volumes Généreux
        </figcaption>
      </figure>
    </div>
  </div>
</section>

<style>
  @import "../../styles/architecture.css";
</style>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    // Animate Images appearing with parallax
    const figures = document.querySelectorAll(".architecture__figure");

    figures.forEach((figure) => {
      const img = figure.querySelector(".architecture__image");

      // Fade in the figure
      gsap.fromTo(
        figure,
        { opacity: 0, y: 50 },
        {
          opacity: 1,
          y: 0,
          duration: 1,
          ease: "power3.out",
          scrollTrigger: {
            trigger: figure,
            start: "top 85%",
          },
        },
      );

      // Parallax effect on the image
      if (img) {
        gsap.to(img, {
          yPercent: -15,
          ease: "none",
          scrollTrigger: {
            trigger: figure,
            start: "top bottom",
            end: "bottom top",
            scrub: true,
          },
        });
      }
    });
  });
</script>
